<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tra c·ª©u M√£ ƒë·ªÅ - VietNH Startup</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; padding: 50px; background-color: #f4f4f9; }
        .container { background: white; padding: 30px; border-radius: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); display: inline-block; }
        input { padding: 10px; width: 250px; border: 1px solid #ddd; border-radius: 5px; margin-bottom: 10px; }
        button { padding: 10px 20px; background-color: #0070f3; color: white; border: none; border-radius: 5px; cursor: pointer; }
        button:hover { background-color: #0051bb; }
        #result { margin-top: 20px; padding: 15px; border-radius: 5px; min-height: 20px; }
        .success { color: #28a745; background: #e6ffed; border: 1px solid #b7eb8f; }
        .error { color: #dc3545; background: #fff1f0; border: 1px solid #ffa39e; }
    </style>
</head>
<body>

<div class="container">
    <h2>H·ªá th·ªëng Tra c·ª©u M√£ ƒë·ªÅ</h2>
    <p>D√†nh cho sinh vi√™n Startup VietNH</p>
    <input type="text" id="maDeInput" placeholder="Nh·∫≠p m√£ ƒë·ªÅ (VD: 1)...">
    <br>
    <button onclick="traCuu()">T√¨m ki·∫øm</button>
    <div id="result"></div>
</div>

<div class="input-section">
    <h3>1. Tra c·ª©u ƒë·ªãa ch·∫•t</h3>
    <input type="text" id="maDeInput" placeholder="Nh·∫≠p m√£ ƒë·ªÅ (VD: 2)...">
    <button onclick="traCuu()">L·∫•y d·ªØ li·ªáu ƒë·ªãa ch·∫•t</button>
</div>

<div id="design-section" style="display:none; margin-top: 20px; border-top: 2px solid #eee; pt: 20px;">
    <h3>2. Th√¥ng s·ªë thi·∫øt k·∫ø m√≥ng</h3>
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; text-align: left;">
        <label>Chi·ªÅu r·ªông m√≥ng B (m): <input type="number" id="inputB" value="1.5"></label>
        <label>Chi·ªÅu d√†i m√≥ng L (m): <input type="number" id="inputL" value="2.0"></label>
        <label>Chi·ªÅu s√¢u ch√¥n m√≥ng Df (m): <input type="number" id="inputDf" value="1.5"></label>
        <label>T·∫£i tr·ªçng ƒë·ª©ng N (kN): <input type="number" id="inputN" value="500"></label>
    </div>
    <button onclick="tinhToanMong()" style="background-color: #28a745; margin-top: 15px;">T√≠nh to√°n s·ª©c ch·ªãu t·∫£i</button>
</div>

<div id="result"></div>
<div id="calc-result" style="margin-top: 20px;"></div>

<script>
    const SUPABASE_URL = "https://ezksahbyqwnbaabulhhd.supabase.co"; // URL c·ªßa b·∫°n
    const SUPABASE_KEY = "sb_publishable_o1TDH7-ji0GCdebRKzgUIA__fzNTGX1"; // API Key c·ªßa b·∫°n

    async function traCuu() {
      const input = document.getElementById('maDeInput').value.trim();
      const resultDiv = document.getElementById('result');
      
      if (!input) {
          alert("Vui l√≤ng nh·∫≠p m√£ ƒë·ªÅ!");
          return;
      }

      resultDiv.innerHTML = "ƒêang t√¨m ki·∫øm...";
      resultDiv.className = "";

      try {
          // G·ªçi ƒë·∫øn ƒë√∫ng t√™n b·∫£ng ShallowFoundationCode v√† c·ªôt SFcode
          const response = await fetch(`${SUPABASE_URL}/rest/v1/ShallowFoundationCode?SFcode=eq.${input}`, {
              headers: {
                  "apikey": SUPABASE_KEY,
                  "Authorization": `Bearer ${SUPABASE_KEY}`
              }
          });

          const data = await response.json();

          if (data.length > 0) {
              const info = data[0];
              // Hi·ªÉn th·ªã t·∫•t c·∫£ c√°c th√¥ng s·ªë k·ªπ thu·∫≠t t·ª´ b·∫£ng c·ªßa b·∫°n
              resultDiv.innerHTML = `
                  <div style="text-align: left; line-height: 1.6;">
                      <p>‚úÖ <b>M√£ ƒë·ªÅ:</b> ${info.SFcode}</p>
                      <p>üìç <b>M√£ m·∫∑t b·∫±ng:</b> ${info.Plancode}</p>
                      <hr>
                      <p><b>L·ªõp ƒë·∫•t 1:</b> ${info.L1name} (D√†y: ${info.L1thickn}m)</p>
                      <p><b>L·ªõp ƒë·∫•t 2:</b> ${info.L2name} (D√†y: ${info.L2thickn}m)</p>
                  </div>`;
              resultDiv.className = "success";
          } else {
              resultDiv.innerHTML = "‚ùå Kh√¥ng t√¨m th·∫•y m√£ ƒë·ªÅ n√†y!";
              resultDiv.className = "error";
          }
      } catch (error) {
          resultDiv.innerHTML = "‚ö†Ô∏è L·ªói k·∫øt n·ªëi d·ªØ li·ªáu!";
          resultDiv.className = "error";
      }
    }
</script>

</body>
</html>